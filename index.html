<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Nosso Grande Dia</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #f0f4f8, #e6f7ff);
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            text-align: center;
        }
        img {
            width: 180px;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        .card {
            background: #fff;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            max-width: 450px;
            width: 100%;
        }
        h1 {
            color: #28a745;
            font-size: 2rem;
            margin-bottom: 10px;
        }
        p {
            color: #555;
            font-size: 1rem;
            margin-bottom: 20px;
        }
        .btn {
            background-color: #28a745;
            color: #fff;
            border: none;
            padding: 12px 20px;
            margin: 8px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: transform 0.2s, background-color 0.3s;
        }
        .btn:hover {
            background-color: #218838;
            transform: scale(1.05);
        }
        .copy-btn { background-color: #007bff; }
        .copy-btn:hover { background-color: #0056b3; }
        .whatsapp-btn { background-color: #25D366; }
        .whatsapp-btn:hover { background-color: #1DA851; }
        #qrcode { margin-top: 20px; }
    </style>
</head>
<body>

    <img src="foto.jpg?v=1" alt="Foto do casal">

    <div class="card">
        <h1>Nosso Grande Dia üíç</h1>
        <p>Estamos prestes a realizar um sonho: oficializar nossa uni√£o!<br>
        Cada contribui√ß√£o √© um gesto de carinho que nos ajuda a dar este passo t√£o especial.<br>
        Escolha um valor e fa√ßa parte da nossa hist√≥ria. Obrigado por caminhar conosco!</p>

        <button class="btn" onclick="gerarQRCode(10)">Contribuir R$10</button>
        <button class="btn" onclick="gerarQRCode(20)">Contribuir R$20</button>
        <button class="btn" onclick="gerarQRCode(30)">Contribuir R$30</button>

        <p>Chave Pix: <span id="pixKey">(21) 982251790</span></p>

        <button class="btn copy-btn" onclick="copiarPix()">Copiar Chave Pix</button>
        <button class="btn whatsapp-btn" onclick="compartilharWhatsApp()">Compartilhar no WhatsApp</button>

        <div id="qrcode"></div>
    </div>

<script>
// ===============================
// CONFIGURA√á√ïES
// ===============================
const rawPixKey = "(21) 982251790";
const pixKey = rawPixKey.replace(/\D/g, '');
const merchantName = "Nosso Grande Dia";
const merchantCity = "SaoPaulo";
let ultimoPayload = null;

// ===============================
// FUN√á√ïES DE SUPORTE
// ===============================
function pad2(n){ return String(n).padStart(2,'0'); }

function crc16(payload){
    let crc = 0xFFFF;
    for (let i = 0; i < payload.length; i++) {
        crc ^= payload.charCodeAt(i) << 8;
        for (let j = 0; j < 8; j++) {
            if ((crc & 0x8000) !== 0) crc = ((crc << 1) ^ 0x1021) & 0xFFFF;
            else crc = (crc << 1) & 0xFFFF;
        }
    }
    return crc.toString(16).toUpperCase().padStart(4, '0');
}

function tag(id, value){ return id + pad2(String(value).length) + String(value); }

// ===============================
// GERA PAYLOAD PIX OFICIAL
// ===============================
function gerarPayloadPIX(amount){
    const amountStr = amount ? Number(amount).toFixed(2) : '';

    let payload = '';
    payload += tag('00','01');

    const gui = 'BR.GOV.BCB.PIX';
    const sub00 = tag('00', gui);
    const sub01 = '01' + pad2(pixKey.length) + pixKey;
    const merchantAccount = sub00 + sub01;
    payload += '26' + pad2(merchantAccount.length) + merchantAccount;

    payload += tag('52','0000');
    payload += tag('53','986');

    if(amountStr){ payload += tag('54', amountStr); }

    payload += tag('58','BR');
    payload += tag('59', merchantName);
    payload += tag('60', merchantCity);

    const txid = '***';
    const adf = '05' + pad2(txid.length) + txid;
    payload += '62' + pad2(adf.length) + adf;

    const toCRC = payload + '6304';
    const crc = crc16(toCRC);
    payload += '63' + '04' + crc;

    return payload;
}

// ===============================
// QR CODE + BOT√ïES
// ===============================
function gerarQRCode(valor){
    const payload = gerarPayloadPIX(valor);
    ultimoPayload = payload;

    const el = document.getElementById('qrcode');
    el.innerHTML = '';
    new QRCode(el, { text: payload, width: 200, height: 200 });

    if (!document.getElementById('copyPayloadBtn')) {
        const btn = document.createElement('button');
        btn.id = 'copyPayloadBtn';
        btn.className = 'btn copy-btn';
        btn.textContent = 'Copiar Pix com Valor';
        btn.onclick = copiarPayload;
        document.querySelector('.card').appendChild(btn);
    }
}

function copiarPayload(){
    if (!ultimoPayload) return alert('Nenhum Pix gerado ainda.');
    navigator.clipboard.writeText(ultimoPayload)
        .then(()=> alert('Pix Copia e Cola copiado!'))
        .catch(()=> prompt('Copie manualmente:', ultimoPayload));
}

function copiarPix(){
    navigator.clipboard.writeText(pixKey);
    alert('Chave Pix copiada!');
}

function compartilharWhatsApp(){
    const mensagem = `Ol√°! üòä Estamos prestes a realizar nosso grande dia! üíç

Quer contribuir para nossa uni√£o?
Acesse nossa p√°gina!

Obrigado pelo carinho! ‚ù§Ô∏è`;

    const url = `https://wa.me/?text=${encodeURIComponent(mensagem)}`;
    window.open(url, '_blank');
}
</script>

</body>
</html>
