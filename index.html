<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Nosso Grande Dia</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

    <style>
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #f0f4f8, #e6f7ff);
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            text-align: center;
        }
        img {
            width: 180px;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        .card {
            background: #fff;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            max-width: 450px;
            width: 100%;
        }
        h1 {
            color: #28a745;
            font-size: 2rem;
            margin-bottom: 10px;
        }
        p {
            color: #555;
            font-size: 1rem;
            margin-bottom: 20px;
        }
        .btn {
            background-color: #28a745;
            color: #fff;
            border: none;
            padding: 12px 20px;
            margin: 8px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            transition: transform 0.2s, background-color 0.3s;
        }
        .btn:hover {
            background-color: #218838;
            transform: scale(1.05);
        }
        .copy-btn { background-color: #007bff; }
        .copy-btn:hover { background-color: #0056b3; }
        .whatsapp-btn { background-color: #25D366; }
        .whatsapp-btn:hover { background-color: #1DA851; }
        #qrcode { margin-top: 20px; }
    </style>
</head>

<body>
    <img src="foto.jpg?v=1" alt="Foto do casal">

    <div class="card">
        <h1>Nosso Grande Dia üíç</h1>
        <p>
            Estamos prestes a realizar um sonho: oficializar nossa uni√£o!<br>
            Cada contribui√ß√£o √© um gesto de carinho que nos ajuda a dar este passo t√£o especial.<br>
            Escolha um valor e fa√ßa parte da nossa hist√≥ria. Obrigado por caminhar conosco!
        </p>

        <button class="btn" onclick="gerarQRCode(10)">Contribuir R$10</button>
        <button class="btn" onclick="gerarQRCode(20)">Contribuir R$20</button>
        <button class="btn" onclick="gerarQRCode(30)">Contribuir R$30</button>

        <p>Chave Pix: <span id="pixKey">(21) 982251790</span></p>

        <button class="btn copy-btn" onclick="copiarPix()">Copiar Chave Pix</button>
        <button class="btn whatsapp-btn" onclick="compartilharWhatsApp()">Compartilhar no WhatsApp</button>

        <div id="qrcode"></div>
    </div>

    <script>
        // === CONFIGURA√á√ÉO ===
        const pixKey = document.getElementById("pixKey").textContent;
        const nomeRecebedor = "RODRIGO BATISTA";
        const cidadeRecebedor = "RIODEJANEIRO";

        // === C√ÅLCULO CRC16 OFICIAL BACEN ===
        function crc16(payload) {
            let crc = 0xFFFF;
            for (let i = 0; i < payload.length; i++) {
                crc ^= payload.charCodeAt(i) << 8;
                for (let j = 0; j < 8; j++) {
                    crc = (crc & 0x8000) ? (crc << 1) ^ 0x1021 : (crc << 1);
                    crc &= 0xFFFF;
                }
            }
            return crc.toString(16).toUpperCase().padStart(4, "0");
        }

        // === GERADOR DE PIX COPIA E COLA ===
        function gerarPayload(valor) {
            const valorFormatado = valor.toFixed(2);

            const gui = "BR.GOV.BCB.PIX";
            const campoChave = `01${pixKey.length.toString().padStart(2, "0")}${pixKey}`; 
            const merchantAccountInfo = `26${(4 + gui.length + campoChave.length).toString().padStart(2, "0")}00${gui.length.toString().padStart(2, "0")}${gui}${campoChave}`;

            const valorField = `54${valorFormatado.length.toString().padStart(2, "0")}${valorFormatado}`;
            const nomeField = `59${nomeRecebedor.length.toString().padStart(2, "0")}${nomeRecebedor}`;
            const cidadeField = `60${cidadeRecebedor.length.toString().padStart(2, "0")}${cidadeRecebedor}`;

            let payload =
                "000201" +
                merchantAccountInfo +
                "52040000" +
                "5303986" +
                valorField +
                "58" + "02" + "BR" +
                nomeField +
                cidadeField +
                "62070503***" +
                "6304";

            return payload + crc16(payload);
        }

        // === QR CODE ===
        function gerarQRCode(valor) {
            const payload = gerarPayload(valor);
            window.ultimoPayload = payload;

            document.getElementById("qrcode").innerHTML = "";
            new QRCode(document.getElementById("qrcode"), {
                text: payload,
                width: 220,
                height: 220
            });

            if (!document.getElementById("copyPayloadBtn")) {
                const btn = document.createElement("button");
                btn.id = "copyPayloadBtn";
                btn.className = "btn copy-btn";
                btn.textContent = "Copiar Pix com Valor";
                btn.onclick = copiarPayload;
                document.querySelector(".card").appendChild(btn);
            }
        }

        function copiarPayload() {
            if (window.ultimoPayload) {
                navigator.clipboard.writeText(window.ultimoPayload);
                alert("Pix com valor copiado!");
            }
        }

        function copiarPix() {
            navigator.clipboard.writeText(pixKey);
            alert("Chave Pix copiada!");
        }

        // === WHATSAPP CORRIGIDO ===
        function compartilharWhatsApp() {
            const mensagem = `Ol√°, amigos! üòä
Criamos esta p√°gina com muito carinho para reunir uma ajuda simb√≥lica e conseguirmos realizar nosso sonho: oficializar nossa uni√£o e obter nosso documento de casamento. üíç‚ú®
Se voc√™ quiser fazer parte desse momento especial, √© s√≥ acessar o link abaixo.
Agradecemos de cora√ß√£o pelo carinho e apoio! ‚ù§Ô∏è`;

            const url = "https://wa.me/?text=" + encodeURIComponent(mensagem);
            window.open(url, "_blank");
        }
    </script>
</body>
</html>
